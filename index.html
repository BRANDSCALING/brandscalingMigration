<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Brandscaling Platform</title>
    <script>
      // WebSocket override - must run before any other scripts
      (function () {
        const OriginalWebSocket = window.WebSocket;
        class DummyWebSocket {
          onopen = null;
          onmessage = null;
          onerror = null;
          onclose = null;
          close() {}
          send() {}
          addEventListener() {}
          removeEventListener() {}
          dispatchEvent() { return false; }
          readyState = 3;
        }

        window.WebSocket = function (url, protocols) {
          if (typeof url === 'string' && (url.includes('localhost:undefined') || url.includes(':undefined'))) {
            return new DummyWebSocket();
          }
          try {
            return new OriginalWebSocket(url, protocols);
          } catch (err) {
            return new DummyWebSocket();
          }
        };

        // Suppress console messages from Vite
        const originalConsoleLog = console.log;
        console.log = (...args) => {
          const message = args.join(' ');
          if (message.includes('[vite] connecting') || message.includes('[vite] connected')) {
            return;
          }
          originalConsoleLog.apply(console, args);
        };

        // Suppress unhandled rejection events related to WebSocket
        window.addEventListener('unhandledrejection', (event) => {
          const reason = event.reason;
          if (reason?.message?.includes('WebSocket') || 
              reason?.message?.includes('localhost:undefined') ||
              reason?.name === 'DOMException') {
            event.preventDefault();
          }
        });
      })();
    </script>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/client/src/main.tsx"></script>
  </body>
</html>